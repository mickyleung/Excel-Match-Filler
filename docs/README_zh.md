# Excel數據匹配填充工具 - 使用說明
## 功能介紹
本工具是基於Python開發的GUI桌面應用，支援**多列聯合匹配**和繁中/英文雙語切換，主要用於將表1的數據根據指定匹配列填充到表2對應列中。

### 核心功能
✅ 支援多列匹配（如訂單號+產品碼聯合匹配）  
✅ 繁中/英文界面一鍵切換  
✅ Excel文件讀取/填充/保存（支援.xlsx/.xls格式）  
✅ 數據預覽（前10行），便於驗證匹配結果  
✅ 完善的錯誤提示和防錯機制  

## 安裝與執行
### 方式1：直接執行EXE（推薦）
1. 前往GitHub Releases頁面下載打包好的`Excel數據匹配工具.exe`；
2. 雙擊執行（無需安裝Python）；
3. 注意：請將EXE放在**純英文路徑**下執行（避免中文亂碼）。

### 方式2：源碼執行
1. 安裝Python 3.8~3.10（推薦3.10）；
2. 克隆倉庫：
   ```bash
   git clone https://github.com/mickyleung/Excel-Match-Filler.git
   cd Excel-Match-Filler
   ```
3. 安裝依賴：
   ```bash
   pip install -r src/requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
   ```
4. 執行程式：
   ```bash
   python src/excel_matcher.py
   ```

### 方式3：手動打包EXE
1. 安裝PyInstaller：
   ```bash
   pip install pyinstaller
   ```
2. 進入源碼目錄打包：
   ```bash
   cd src
   pyinstaller -F -w --hidden-import openpyxl --hidden-import xlrd --name EXCEL_MATCH_FILLER main.py
   ```
3. 打包後的EXE位於`src/dist/`目錄下。

## 使用步驟
### 1. 文件選擇
- **數據源文件（表1）**：選擇包含待填充數據的Excel文件；
- **目標文件（表2）**：選擇需要填充數據的Excel文件；
- **工作表**：選擇對應的工作表名（工具會自動加載文件中的所有工作表）；
- **輸出文件**：設定填充結果的保存路徑（預設：填充結果.xlsx）。

### 2. 加載列名
點擊「加載列名」按鈕，工具會讀取選定工作表的所有列名，並填充到後續下拉框中。

### 3. 匹配列配置（必選）
匹配列是用於關聯表1和表2數據的關鍵列，支援多列匹配：
1. 在「表1匹配列」下拉框選擇列名 → 點擊「確認選擇」；
2. 在「表2匹配列」下拉框選擇對應列名 → 點擊「確認選擇」；
3. 點擊「添加匹配列對」，列對會顯示在下方列表框中；
4. 重複1-3步添加多組匹配列（如訂單號+產品碼）；
5. 如需調整：
   - 按住Ctrl鍵選中列表框中的列對 → 點擊「移除選中匹配列」；
   - 點擊「清空匹配列」一鍵重置。

### 4. 填充列配置（必選）
填充列是需要從表1填充到表2的列：
1. 在「表1填充列」下拉框選擇列名 → 點擊「確認選擇」；
2. 在「表2填充列」下拉框選擇目標列名 → 點擊「確認選擇」；
3. 點擊「添加填充列」，列對會顯示在下方列表框中；
4. 支援多組填充列添加/移除/清空（操作邏輯同匹配列）。

### 5. 預覽與執行
- **預覽數據**：點擊「✅ 預覽數據」，工具會顯示前10行匹配填充結果，便於驗證；
- **執行填充**：點擊「🚀 執行填充」，工具會按配置填充數據並保存到輸出文件；
- **重置所有**：點擊「🔄 重置所有」，清空所有配置並還原初始狀態。

## 常見問題
### Q1：執行填充時提示「文件被佔用」？
A1：關閉正在打開的Excel文件（表1/表2/輸出文件），重新執行。

### Q2：匹配結果為空？
A2：檢查匹配列的列名是否正確、數據格式是否一致（如數字/文本格式）。

### Q3：界面文字亂碼？
A3：將EXE文件放在純英文路徑下執行（如`D:\Tools\EXCEL_MATCH_FILLER.exe`）。

### Q4：加載列名失敗？
A4：檢查Excel文件是否損壞，或工作表名是否正確。

### Q5：多列匹配後數據未填充？
A5：確保所有匹配列的數據都能對應上（多列匹配需同時滿足所有列的匹配條件）。

## 環境要求
- 作業系統：Windows 10/11（64位）；
- Python版本（源碼執行）：3.8~3.10（3.11+可能存在兼容問題）；
- Excel格式：支援.xlsx/.xls（推薦.xlsx）。

## 注意事項
1. 建議在執行前備份原始Excel文件，避免數據丟失；
2. 匹配列的數據格式需一致（如表1「訂單號」為文本，表2也需為文本）；
3. 多列匹配時，所有匹配列需同時滿足才能成功匹配；
4. 若EXE被防毒軟體誤判為惡意程式，請手動添加信任；
5. 工具僅讀取和寫入Excel文件，不會上傳任何數據，可放心使用。

## 故障排除
| 錯誤現象                | 可能原因                          | 解決方案                                  |
|-------------------------|-----------------------------------|-------------------------------------------|
| 啟動EXE無反應           | 路徑包含中文/特殊字符             | 移動EXE到純英文路徑（如`D:\ExcelTool\`）  |
| 加載文件失敗            | Excel文件被占用/損壞              | 關閉Excel、更換完整文件路徑              |
| 填充後數據重複          | 表1存在重複的匹配列數據           | 清理表1重複數據後重新填充                |
| 界面按鈕失效            | Python依賴缺失（源碼執行）        | 重新安裝依賴：`pip install -r requirements.txt` |
